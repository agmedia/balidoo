{{ header }}
<!-- End Glami piXel -->
{% if product_layout != "full-width" %}
<style>
    .product-page .image-area {
        {% if product_layout == "images-left" and images %}
            width: {{img_w + img_a_w + 20 }}px;
        {% else %}
            width: {{ img_w }}px;
        {% endif %}
        }
        .product-page .main-image {
            width:{{ img_w }}px;
        }
        .product-page .image-additional {
        {% if product_layout == "images-left" %}
            width: {{ img_a_w }}px;
            height: {{ img_h }}px;
        {% else %}
            width: {{ img_w }}px;
        {% endif %}
        }
        .product-page .image-additional.has-arrows {
        {% if product_layout == "images-left" %}
            height: {{ img_h - 40 }}px;
        {% endif %}
        }
        @media (min-width: 992px) and (max-width: 1199px) {
            .product-page .image-area {
            {% if product_layout == "images-left" %}
                width: {{((img_w + img_a_w)/1.25 + 20) }}px;
            {% else %}
                width: {{ img_w/1.25 }}px;
            {% endif %}
            }
            .product-page .main-image {
                width:{{ img_w/1.25 }}px;
            }
            .product-page .image-additional {
            {% if product_layout == "images-left" %}
                width: {{ img_a_w/1.25 }}px;
                height: {{ img_h/1.25 }}px;
            {% else %}
                width: {{ img_w/1.25 }}px;
            {% endif %}
            }
        }
</style>
{% endif %}

<ul class="breadcrumb">
    {% for breadcrumb in breadcrumbs %}
    <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
    {% endfor %}
</ul>

<div class="container product-layout {{ product_layout }}">

    <div class="row">{{ column_left }} {% if column_left and column_right %} {% set class = 'col-sm-6' %} {% elseif column_left or column_right %} {% set class = 'col-md-9 col-sm-8' %} {% else %} {% set class = 'col-sm-12' %} {% endif %}
        <div id="content" class="product-main no-min-height {{ class }}">
            {{ content_top }}

            <div class="table product-info product-page">

                <div class="table-cell left">

                    {% if thumb or images %}


                    <div class="carousel image-area   grid-holder m0" id="gallery">

                        {% if thumb %}
                        <div class=" item single-product ppage">

                            {% if price and special and sale_badge %}
                            <span class="badge sale_badge"><i>{{ sale_badge }}</i></span> {% endif %} {% if is_new %}
                            <span class="badge new_badge"><i>{{ basel_text_new }}</i></span> {% endif %} {% if ((qty
                            < 1) and (stock_badge_status)) %} <span class="badge out_of_stock_badge"><i>{{ basel_text_out_of_stock}}</i></span>
                                {% endif %}

                                <a class="{% if not images %}link cloud-zoom{% endif %} {% if product_layout == 'full-width' %}link{% else %}cloud-zoom{% endif %}" id="main-image" href="{{ popup }}" rel="position:'inside', showTitle: false"><img src="{{ thumb }}" title="{{ heading_title }}" alt="{{ heading_title }}" /></a>
                        </div>
                        {% endif %} {% for image in images %}
                        <div class=" item single-product ppage">
                            <a class="link {% if product_layout != 'full-width' %}cloud-zoom-gallery locked{% endif %}" href="{{ image.popup }}" rel="useZoom: 'ppage', smallImage: '{{ image.thumb_lg }}'"><img src="{{ image.thumb }}" title="{{ heading_title }}" alt="{{ heading_title }}" /></a>
                        </div>
                        {% endfor %}

                        
               {% if upc %}
           <div class=" item single-product ppage nobck">
                 <video id="sampleMovie" width="100%" height="auto" autoplay controls loop muted playsinline >
                     <source src="https://balidoo.agmedia.rocks/image/video/{{ upc }}" />

                 </video>

             </div>
          {% endif %}




                    </div>





                    {% endif %}
                </div>
                <!-- .table-cell.left ends -->
                <script>
                    $(function() {
                        $('.carousel.image-area').slick({
                            prevArrow: false,
                            nextArrow: false,
                            dots:true,
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            mobileFirst: true,
                            responsive: [
                                {
                                    breakpoint: 768,
                                    settings: 'unslick'
                                }
                            ]
                        });
                    });

                    $(window).resize(function() {
                        $('.carousel').slick('resize');

                    });
                </script>

                <div class="table-cell w100 right">
                    <div class="inner">

                        <div class="product-h1">
                            <h1 id="page-title">{{ heading_title }}</h1>
                        </div>
                        <p class="info skuo ">Šifra proizvoda: {{ model }}</p>

                        {% if review_status and (review_qty > 0) %}
                        <div class="rating">
                            <span class="rating_stars rating r{{ rating }}">
                                      <i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i>
                             </span>
                        </div>
                        <span class="review_link">(<a class="hover_uline to_tabs" onclick="$('a[href=\'#tab-review\']').trigger('click'); return false;">{{ reviews }}</a>)</span> {% endif %} {% if price %}
                        <ul class="list-unstyled price">
                            {% if not special %}
                            <li><span class="live-price">{{ price }}<span></li>
                                {% else %}
                                    <li><span class="price-old">{{ price }}</span><span class="live-price-new">{{ special }}<span></li>
                                    <span id="special_countdown"></span> {% endif %}
                        </ul>

                        {% if special %}
                        <p>Najniža cijena posljednih 30 dana: {{ price }} </p>

                        {% endif %} {% if discounts %}
                        <p class="discount">
                            {% for discount in discounts %}
                            <span>{{ discount.quantity }}{{ text_discount }}<i class="price">{{ discount.price }}</i></span> {% endfor %}
                        </p>
                        {% endif %} {% endif %}
                        <!-- if price ends -->




                        {% if meta_description_status and meta_description %}
                        <p class="meta_description">{{ meta_description }}</p>
                        {% endif %}


                        <div id="product">

                            {% if options %}
                            <div class="options">
                                {% for option in options %} {% if option.type == 'select' %}
                                <div class="form-group{% if option.required %} required{% endif %} ">
                                    <div class="table-cell name">
                                        <label class="control-label" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                                    </div>
                                    <div class="table-cell">
                                        <select name="option[{{ option.product_option_id }}]" id="input-option{{ option.product_option_id }}" class="form-control">
                                            <option value="">{{ text_select }}</option>
                                            {% for option_value in option.product_option_value %}
                                            <option value="{{ option_value.product_option_value_id }}">{{ option_value.name }} {% if option_value.price %} ({{ option_value.price_prefix }}{{ option_value.price }}) {% endif %}
                                            </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                                {% endif %} {% if option.type == 'radio' %}
                                <div class="form-group{% if option.required %} required {% endif %}   mb-0 ">
                                    <div class="table-cell name">
                                        <label class="control-label" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                                    </div>
                                    <div class=" radio-cell">
                                        <div id="input-option{{ option.product_option_id }}">
                                            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                                {% for option_value in option.product_option_value %}

                                                <label class="btn btn-outline btn-option ">
                                                    <input type="radio" name="option[{{ option.product_option_id }}]" value="{{ option_value.product_option_value_id }}" data-uid="{{ option_value.sifra }}" /> {% if option_value.image %}
                                                    <img src="{{ option_value.image }}" alt="{{ option_value.name }}{% if option_value.price %}({{ option_value.price_prefix }}{{ option_value.price }}){% endif %}" data-toggle="tooltip" data-title="{{ option_value.name }}{% if option_value.price %} ({{ option_value.price_prefix }}{{ option_value.price }}){% endif %}"
                                                    /> {% endif %}
                                                       <span class="name">
                                                                      {{ option_value.name }}
                                                                        {% if option_value.price %}
                                                                            ({{ option_value.price_prefix }}{{ option_value.price }})
                                                                        {% endif %}
                                                       </span>
                                                </label>

                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% if option.name == 'Veličina' %}
                                <p>
                                    <a href="https://www.balidoo.hr/vodic-za-velicine" > <img src="image/size_guide.svg" class="filter-icon" alt="Vodič za veličine" /> Vodič za veličine</a>
                                </p>
                                {% endif %} {% endif %} {% if option.type == 'checkbox' %}
                                <div class="form-group{% if option.required %} required{% endif %} ">
                                    <div class="table-cell checkbox-cell name">
                                        <label class="control-label">{{ option.name }}</label>
                                    </div>
                                    <div class="table-cell checkbox-cell">
                                        <div id="input-option{{ option.product_option_id }}">
                                            {% for option_value in option.product_option_value %}
                                            <div class="checkbox{% if option_value.image %} has-image{% endif %}">
                                                <label>
                                                    <input type="checkbox" name="option[{{ option.product_option_id }}][]" value="{{ option_value.product_option_value_id }}" /> {% if option_value.image %}
                                                    <img src="{{ option_value.image }}" alt="{{ option_value.name }}{% if option_value.price %}({{ option_value.price_prefix }}{{ option_value.price }}){% endif %}" data-toggle="tooltip" data-title="{{ option_value.name }}{% if option_value.price %} ({{ option_value.price_prefix }}{{ option_value.price }}){% endif %}"
                                                    /> {% endif %}
                                                    <span class="name">
                                                             {{ option_value.name }}
                                                                        {% if option_value.price %}
                                                                            ({{ option_value.price_prefix }}{{ option_value.price }})
                                                                        {% endif %}
                                                    </span>
                                                </label>
                                            </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                {% endif %} {% endfor %}
                                <!-- foreach option -->
                            </div>





                            {% endif %}




                            <div class="add-to-cart-section">
                                <div class="add-to-cart-container">
                                    <div class="cd-add-section active">
                                        <div class="cd-qty quantity buttons_added">
                                            <!--   <input type="number" step="1" min="{{ minimum }}" name="quantity" value="{{ minimum }}" id="input-quantity" class="form-control  put-qty" />-->

                                            <input type="button" value="-" class="minus">
                                            <input type="text" step="1" min="1" max="" id="input-quantity" name="quantity" value="{{ minimum }}" title="Qty" class="input-text qty text put-qty" size="4" pattern="" inputmode="">
                                            <input type="button" value="+" class="plus">
                                        </div>
                                        <input type="hidden" name="product_id" value="{{ product_id }}" /> {% if ((qty
                                        < 1) and (stock_badge_status)) %} <button type="button" data-loading-text="{{ text_loading }}" class="btn btn-primary cd-btn-add"><span>{{ basel_text_out_of_stock }}</span></button>
                                            {% else %}
                                            <button type="button" id="button-cart" data-loading-text="{{ text_loading }}" class="btn btn-primary cd-btn-add"><span>{{ button_cart }}</span></button>

                                            {% endif %}
                                    </div>
                                </div>

                                <!--<div class="add-to-wishlist cd-add-to-wishlist cd-wishlist" >
                          <a onclick="wishlist.add('{{ product_id }}');" class="btn-add-to-wishlist"><i class="icon-heart"></i> </a>
                          </div>-->
                            </div>
                            <div class="text-center freeshipping-label"><span>Besplatna dostava za narudžbe iznad 50€</span></div>

                            {% if minimum > 1 %}
                            <div class="alert alert-sm alert-info"><i class="fa fa-info-circle"></i> {{ text_minimum }}</div>
                            {% endif %}
                         {% set free_shipping_threshold = 50 %}  {# npr. 50 (EUR). Stavi svoj prag! #}
<div id="free-ship-wrap"
     data-threshold="{{ free_shipping_threshold }}"
     data-msg-template="{{ 'Dodaj još %s za BESPLATNU dostavu.' }}"
     data-currency="{{ currency }}">

  {% if freeshipppingnotification %}
    <div class="progress">
      <div class="progress-bar progress-bar-success progress-bar-striped active"
           role="progressbar"
           aria-valuenow="{{ percent|default(0) }}"
           aria-valuemin="0" aria-valuemax="100"
           style="width:{{ percent|default(0) }}%"></div>

      <div class="otext"><i class="icon-truck"></i> {{ freeshipppingnotification }}</div>
    </div>
  {% endif %}
</div>

                        </div>




                        <div class="row">
                            <div class="col-sm-12">


                                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                                    <div class="panel panel-default">
                                        <div class="panel-heading" role="tab" id="headingOne">
                                            <h4 class="mb-0 accordion-toggle panel-title" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                                {{ tab_description }}

                                            </h4>
                                        </div>
                                        <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                            <div style="padding:10px 0">
                                                {{ description }}
                                            </div>

                                        </div>
                                    </div>


                                    {% if product_tabs %} {% for tab in product_tabs %}

                                    <div class="panel panel-default">
                                        <div class="panel-heading" role="tab" id="heading{{ tab.tab_id }}">
                                            <h4 class="mb-0 accordion-toggle panel-title" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse{{ tab.tab_id }}" aria-expanded="false" aria-controls="collapse{{ tab.tab_id }}">
                                                        {{ tab.name }}

                                                    </h4>
                                        </div>
                                        <div id="collapse{{ tab.tab_id }}" class="panel-collapse collapse " role="tabpanel" aria-labelledby="heading{{ tab.tab_id }}">
                                            <div style="padding:10px 0">
                                                {{ tab.description }}
                                            </div>

                                        </div>
                                    </div>



                                    {% endfor %} {% endif %} {% if attribute_groups %}
                                    <div class="panel panel-default">
                                        <div class="panel-heading" role="tab" id="headingTwo">
                                            <h4 class="panel-title">
                                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                                        Sastav i održavanje
                                                    </a>
                                                </h4>
                                        </div>
                                        <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                                            <div class="panel-body">

                                                {% if attribute_groups %}
                                                <div class="tab-pane" id="tab-specification">
                                                    <table class="table specification">
                                                        {% for attribute_group in attribute_groups %}
                                                       
                                                        <tbody>
                                                            {% for attribute in attribute_group.attribute %}
                                                            <tr>
                                                                <td class="text-left"><b>{{ attribute.name }}</b></td>
                                                                <td class="text-right">{{ attribute.text }}</td>
                                                            </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                        {% endfor %}
                                                    </table>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    {% endif %} {% if review_status %}
                                    <div class="panel panel-default">
                                        <div class="panel-heading" role="tab" id="headingThree">
                                            <h4 class="mb0">
                                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                                        {{ tab_review }}
                                                    </a>
                                                </h4>
                                        </div>
                                        <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                                            <div class="panel-body">
                                                {% if review_status %}
                                                <div class="tab-pane" id="tab-review">
                                                    <div class="row">
                                                        <div class="col-sm-6">
                                                            <h4><b>{{ button_reviews }}</b></h4>

                                                            <div id="review">
                                                                {% if seo_reviews %} {% for review in seo_reviews %}
                                                                <div class="table">
                                                                    <div class="table-cell"><i class="fa fa-user"></i></div>
                                                                    <div class="table-cell right">
                                                                        <p class="author"><b>{{ review.author }}</b> - {{ review.date_added }}
                                                                            <span class="rating">
                                                          <span class="rating_stars rating r{{ review.rating }}">
                                                          <i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i>
                                                          </span>
                                                                            </span>
                                                                        </p>
                                                                        {{ review.text }}
                                                                    </div>
                                                                </div>
                                                                {% endfor %} {% if pagination %}
                                                                <div class="pagination-holder">{{ pagination }}</div>
                                                                {% endif %} {% else %}
                                                                <p>{{ text_no_reviews }}</p>
                                                                {% endif %}
                                                            </div>

                                                        </div>
                                                        <div class="col-sm-6 right">
                                                            <form class="form-horizontal" id="form-review">

                                                                <h4 id="review-notification"><b>{{ text_write }}</b></h4> {% if review_guest %}

                                                                <div class="form-group required">
                                                                    <div class="col-sm-12 rating-stars">
                                                                        <label class="control-label">{{ entry_rating }}</label>

                                                                        <input type="radio" value="1" name="rating" id="rating1" />
                                                                        <label for="rating1"><i class="fa fa-star-o"></i></label>

                                                                        <input type="radio" value="2" name="rating" id="rating2" />
                                                                        <label for="rating2"><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i></label>

                                                                        <input type="radio" value="3" name="rating" id="rating3" />
                                                                        <label for="rating3"><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i></label>

                                                                        <input type="radio" value="4" name="rating" id="rating4" />
                                                                        <label for="rating4"><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i></label>

                                                                        <input type="radio" value="5" name="rating" id="rating5" />
                                                                        <label for="rating5"><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i></label>
                                                                    </div>
                                                                </div>

                                                                <div class="form-group required">
                                                                    <div class="col-sm-12">
                                                                        <label class="control-label" for="input-name">{{ entry_name }}</label>
                                                                        <input type="text" name="name" value="{{ customer_name }}" id="input-name" class="form-control grey" />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group required">
                                                                    <div class="col-sm-12">
                                                                        <label class="control-label" for="input-review">{{ entry_review }}</label>
                                                                        <textarea name="text" rows="5" id="input-review" class="form-control grey"></textarea>
                                                                        <small>{{ text_note }}</small>
                                                                    </div>
                                                                </div>

                                                                <div class="form-group required">
                                                                    <div class="col-sm-12">
                                                                        {{ captcha }}
                                                                    </div>
                                                                </div>

                                                                <div class="buttons clearfix">
                                                                    <div class="text-right">
                                                                        <button type="button" id="button-review" data-loading-text="{{ text_loading }}" class="btn btn-outline">{{ button_continue }}</button>
                                                                    </div>
                                                                </div>
                                                                {% else %} {{ text_login }} {% endif %}
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endif %}
                                                <!-- if review-status ends -->
                                            </div>
                                        </div>
                                    </div>


                                    {% endif %}
                                </div>




                            </div>
                            <!-- .col-sm-12 ends -->
                        </div>
                        <!-- .row ends -->

                    </div>
                    <!-- #product ends -->


                </div>
                <!-- .inner ends -->
            </div>
            <!-- .table-cell.right ends -->

        </div>
        <!-- .product-info ends -->

        {% if full_width_tabs %}
    </div>
    <!-- main column ends -->
    {{ column_right }}
</div>
<!-- .row ends -->
</div>
<!-- .container ends -->
{% endif %}





<!-- Related Products -->

{% if full_width_tabs %}
<div class="container">
    {% endif %} {% if products %}
    <div class="widget widget-related" style="margin-bottom:50px">

        <div class="widget-title">
            <p class="main-title">{{ text_related }}</p>

        </div>

        <div class="grid grid-holder related carousel grid{{ basel_rel_prod_grid }}">
            {% for product in products %} {% include 'basel/template/product/single_product.twig' %} {% endfor %}
        </div>
    </div>
    {% endif %} {{ content_bottom }} {% if full_width_tabs %}
</div>
{% endif %} {% if bought_products %}

<div class="container">


    <div class="widget widget-related " style="margin-bottom:50px">

        <div class="widget-title">
            <p class="main-title">{{ module_bought_product_title }}</p>

        </div>

        <div class="grid grid-holder related carousel grid{{ basel_rel_prod_grid }}">
            {% for product in bought_products %} {% include 'basel/template/product/single_product.twig' %} {% endfor %}
        </div>
    </div>
</div>

{% endif %} {% if not full_width_tabs %}
</div>
<!-- main column ends -->
{{ column_right }}
</div>
<!-- .row ends -->
</div>
<!-- .container ends -->
{% endif %}

<script src="catalog/view/theme/basel/js/lightgallery/js/lightgallery.min.js"></script>
<script src="catalog/view/theme/basel/js/lightgallery/js/lg-zoom.min.js"></script>
<script src="catalog/view/theme/basel/js/cloudzoom/cloud-zoom.1.0.2.min.js"></script>
{% if basel_price_update %}
<script src="index.php?route=extension/basel/live_options/js&product_id={{ product_id }}"></script>
{% endif %} {% if products %}
<script>
    <!--
            $('.grid-holder.related').slick({
                prevArrow: "<a class=\"arrow-left icon-arrow-left\"></a>",
                nextArrow: "<a class=\"arrow-right icon-arrow-right\"></a>",
                dots:true,
                {% if direction == 'rtl' %}
                rtl: true,
                {% endif %}
                respondTo:'min',
                {% if basel_rel_prod_grid == '5' %}
                slidesToShow:5,slidesToScroll:5,responsive:[{breakpoint:1100,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:960,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},
                    {% elseif basel_rel_prod_grid == '4' %}
                    slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:960,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},
                {% elseif basel_rel_prod_grid == '3' %}
                slidesToShow:3,slidesToScroll:3,responsive:[{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},
                {% elseif basel_rel_prod_grid == '2' %}
                slidesToShow:2,slidesToScroll:2,responsive:[
                {% endif %}
                {% if items_mobile_fw %}
                {breakpoint:320,settings:{slidesToShow:1,slidesToScroll:1}}
                {% endif %}
            ]
            });
            $('.product-style2 .single-product .icon').attr('data-placement', 'top');
            $('[data-toggle=\'tooltip\']').tooltip({container: 'body'});
            //-->
</script>
{% endif %} {% if sale_end_date and product_page_countdown %}
<script>
    $(function() {
            $('#special_countdown').countdown('{{ sale_end_date }}').on('update.countdown', function(event) {
                var $this = $(this).html(event.strftime(''
                    + '<div class=\"special_countdown\"></span><p><span class=\"icon-clock\"></span> {{ basel_text_offer_ends }}</p><div>'
                    + '%D<i>{{ basel_text_days }}</i></div><div>'
                    + '%H <i>{{ basel_text_hours }}</i></div><div>'
                    + '%M <i>{{ basel_text_mins }}</i></div><div>'
                    + '%S <i>{{ basel_text_secs }}</i></div></div>'));
            });
        });
</script>
{% endif %}

<script>
    <!--
        $('select[name=\'recurring_id\'], input[name="quantity"]').change(function(){
            $.ajax({
                url: 'index.php?route=product/product/getRecurringDescription',
                type: 'post',
                data: $('input[name=\'product_id\'], input[name=\'quantity\'], select[name=\'recurring_id\']'),
                dataType: 'json',
                beforeSend: function() {
                    $('#recurring-description').html('');
                },
                success: function(json) {
                    $('.alert-dismissible, .text-danger').remove();
    
                    if (json['success']) {
                        $('#recurring-description').html(json['success']);
                    }
                }
            });
        });
        //-->
</script>

<script>
    function wcqib_refresh_quantity_increments() {
        jQuery("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").each(function(a, b) {
            var c = jQuery(b);
            c.addClass("buttons_added"), c.children().first().before('<input type="button" value="-" class="minus" />'), c.children().last().after('<input type="button" value="+" class="plus" />')
        })
    }
    String.prototype.getDecimals || (String.prototype.getDecimals = function() {
        var a = this,
            b = ("" + a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
        return b ? Math.max(0, (b[1] ? b[1].length : 0) - (b[2] ? +b[2] : 0)) : 0
    }), jQuery(document).ready(function() {
        wcqib_refresh_quantity_increments()
    }), jQuery(document).on("updated_wc_div", function() {
        wcqib_refresh_quantity_increments()
    }), jQuery(document).on("click", ".plus, .minus", function() {
        var a = jQuery(this).closest(".quantity").find(".qty"),
            b = parseFloat(a.val()),
            c = parseFloat(a.attr("max")),
            d = parseFloat(a.attr("min")),
            e = a.attr("step");
        b && "" !== b && "NaN" !== b || (b = 0), "" !== c && "NaN" !== c || (c = ""), "" !== d && "NaN" !== d || (d = 0), "any" !== e && "" !== e && void 0 !== e && "NaN" !== parseFloat(e) || (e = 1), jQuery(this).is(".plus") ? c && b >= c ? a.val(c) : a.val((b + parseFloat(e)).toFixed(e.getDecimals())) : d && b <= d ? a.val(d) : b > 0 && a.val((b - parseFloat(e)).toFixed(e.getDecimals())), a.trigger("change")
    });
</script>

<script>
    <!--
        $('#button-cart').on('click', function() {
            $.ajax({
                url: 'index.php?route=extension/basel/basel_features/add_to_cart',
                type: 'post',
                data: $('#product input[type=\'text\'], #product input[type=\'hidden\'], #product input[type=\'number\'], #product input[type=\'radio\']:checked, #product input[type=\'checkbox\']:checked, #product select, #product textarea'),
                dataType: 'json',
                beforeSend: function(json) {
                    $('body').append('<span class="basel-spinner ajax-call"></span>');
                },
    
                success: function(json) {
                    $('.alert, .text-danger').remove();
                    $('.table-cell').removeClass('has-error');
    
                    if (json.error) {
                        $('.basel-spinner.ajax-call').remove();
                        if (json.error.option) {
                            for (i in json.error.option) {
                                var element = $('#input-option' + i.replace('_', '-'));
    
                                if (element.parent().hasClass('input-group')) {
                                    element.parent().after('<div class="text-danger">' + json.error.option[i] + '</div>');
                                } else {
                                    element.after('<div class="text-danger">' + json.error.option[i] + '</div>');
                                }
                            }
                        }
    
                        if (json.error.recurring) {
                            $('select[name=\'recurring_id\']').after('<div class="text-danger">' + json['error']['recurring'] + '</div>');
                        }
    
                        // Highlight any found errors
                        $('.text-danger').parent().addClass('has-error');
                    }
    
                    if (json.success_redirect) {
    
                        location = json.success_redirect;
    
                    } else if (json.success) {
    
                        $('.table-cell').removeClass('has-error');
                        $('.alert, .popup-note, .basel-spinner.ajax-call, .text-danger').remove();
    
                        html = '<div class="popup-note">';
                        html += '<div class="inner">';
                        html += '<a class="popup-note-close" onclick="$(this).parent().parent().remove()">&times;</a>';
                        html += '<div class="table">';
                        html += '<div class="table-cell v-top img"><img src="' + json.image + '" /></div>';
                        html += '<div class="table-cell v-top">' + json.success + '</div>';
                        html += '</div>';
                        html += '</div>';
                        html += '</div>';
                        $('body').append(html);
                        setTimeout(function() {$('.popup-note').hide();}, 8100);
                        // Need to set timeout otherwise it wont update the total
                        setTimeout(function () {
                            $('.cart-total-items').html( json.total_items );
                            $('.cart-total-amount').html( json.total_amount );

                             // NOVO: ažuriraj progress bar bez backend promjena
                    updateFreeShippingUI(json.total_amount);
                        }, 100);
    
                        $('#cart-content').load('index.php?route=common/cart/info #cart-content > *');
                    }
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
            });
        });
        //-->
</script>
<script>
    // Pomoćno: robustno parsiranje iznosa iz stringa (radi s "1.234,56 kn" i "1,234.56 €")
function parseMoneyToFloat(str) {
  if (typeof str !== 'string') return 0;
  // makni sve osim znamenki, točke i zareza
  var s = str.replace(/[^\d.,-]/g, '');
  // ako ima i točku i zarez -> pretpostavi da je tisućica prva koja se pojavljuje
  var hasDot = s.indexOf('.') !== -1;
  var hasComma = s.indexOf(',') !== -1;
  if (hasDot && hasComma) {
    if (s.indexOf('.') < s.indexOf(',')) {
      // format "1.234,56" -> ukloni točke, zamijeni zarez točkom
      s = s.replace(/\./g, '').replace(',', '.');
    } else {
      // format "1,234.56" -> ukloni zareze
      s = s.replace(/,/g, '');
    }
  } else if (hasComma) {
    // format "1234,56" -> zarez je decimalni
    s = s.replace(',', '.');
  }
  var n = parseFloat(s);
  return isNaN(n) ? 0 : n;
}

function formatCurrency(amount) {
  try {
    var currency = $('#free-ship-wrap').data('currency') || undefined;
    // Pokušaj s Intl; ako nemaš currency code, bar formatiraj broj
    return new Intl.NumberFormat(undefined, currency ? { style: 'currency', currency: currency } : { maximumFractionDigits: 2 }).format(amount);
  } catch(e) {
    return amount.toFixed(2);
  }
}

function updateFreeShippingUI(totalAmountStr) {
  var $wrap = $('#free-ship-wrap');
  if (!$wrap.length) return;

  var threshold = parseFloat($wrap.data('threshold')) || 0;
  if (!threshold) return;

  var total = parseMoneyToFloat(totalAmountStr);
  var percent = Math.max(0, Math.min(100, Math.round((total / threshold) * 100)));
  var remaining = Math.max(0, threshold - total);

  // Ako nema progress HTML-a, napravi ga (za slučaj da je inicijalno skriven)
  if (!$wrap.find('.progress').length) {
    var html = '' +
      '<div class="progress">' +
        '<div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%"></div>' +
        '<div class="otext"><i class="icon-truck"></i></div>' +
      '</div>';
    $wrap.append(html);
  }

  var msgTemplate = $wrap.data('msg-template') || 'Do beplatne dostave nedostaje vam %s €';
  var message = '';

  if (total >= threshold) {
    message = 'Imate BESPLATNU dostavu!';
  } else if (total > 0) {
    message = msgTemplate.replace('%s', formatCurrency(remaining));
  } else {
    // Prazna košarica – možeš ostaviti prazno ili početnu poruku
    message = msgTemplate.replace('%s', formatCurrency(threshold));
  }

  $wrap.find('.progress-bar')
       .css('width', percent + '%')
       .attr('aria-valuenow', percent);

  $wrap.find('.otext').html('<i class="icon-truck"></i> ' + message);

  // Ako želiš sakriti kompletan widget kad nema poruke:
  if (message === '') {
     $wrap.find('.progress').hide();
  } else {
     $wrap.find('.progress').show();
  }
}

</script>
<script>
    <!--
        $('.date').datetimepicker({
            pickTime: false
        });
    
        $('.datetime').datetimepicker({
            pickDate: true,
            pickTime: true
        });
    
        $('.time').datetimepicker({
            pickDate: false
        });
    
        $('button[id^=\'button-upload\']').on('click', function() {
            var node = this;
    
            $('#form-upload').remove();
    
            $('body').prepend('<form enctype="multipart/form-data" id="form-upload" style="display: none;"><input type="file" name="file" /></form>');
    
            $('#form-upload input[name=\'file\']').trigger('click');
    
            if (typeof timer != 'undefined') {
                clearInterval(timer);
            }
    
            timer = setInterval(function() {
                if ($('#form-upload input[name=\'file\']').val() != '') {
                    clearInterval(timer);
    
                    $.ajax({
                        url: 'index.php?route=tool/upload',
                        type: 'post',
                        dataType: 'json',
                        data: new FormData($('#form-upload')[0]),
                        cache: false,
                        contentType: false,
                        processData: false,
                        beforeSend: function() {
                            $(node).button('loading');
                        },
                        complete: function() {
                            $(node).button('reset');
                        },
                        success: function(json) {
                            $('.text-danger').remove();
    
                            if (json['error']) {
                                $(node).parent().find('input').after('<div class="text-danger">' + json['error'] + '</div>');
                            }
    
                            if (json['success']) {
                                alert(json['success']);
    
                                $(node).parent().find('input').val(json['code']);
                            }
                        },
                        error: function(xhr, ajaxOptions, thrownError) {
                            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
                }
            }, 500);
        });
        //-->
</script>
<script>
    <!--
        $('#review').delegate('.pagination a', 'click', function(e) {
            e.preventDefault();
            $("html,body").animate({scrollTop:(($("#review").offset().top)-50)},500);
            $('#review').fadeOut(50);
    
            $('#review').load(this.href);
    
            $('#review').fadeIn(500);
    
        });
    
    
        $('#button-review').on('click', function() {
            $.ajax({
                url: 'index.php?route=product/product/write&product_id={{ product_id }}',
                type: 'post',
                dataType: 'json',
                data: $("#form-review").serialize(),
                beforeSend: function() {
                    $('#button-review').button('loading');
                },
                complete: function() {
                    $('#button-review').button('reset');
                },
                success: function(json) {
                    $('.alert-success, .alert-danger').remove();
    
                    if (json.error) {
                        $('#review-notification').after('<div class="alert alert-sm alert-danger"><i class="fa fa-exclamation-circle"></i> ' + json.error + '</div>');
                    }
    
                    if (json.success) {
                        $('#review-notification').after('<div class="alert alert-sm alert-success"><i class="fa fa-check-circle"></i> ' + json.success + '</div>');
    
                        $('input[name=\'name\']').val('');
                        $('textarea[name=\'text\']').val('');
                        $('input[name=\'rating\']:checked').prop('checked', false);
                    }
                }
            });
        });
    
        $(document).ready(function() {
            {% if product_layout == "full-width" %}
    // Sticky information
            $('.table-cell.right .inner').theiaStickySidebar({containerSelector:'.product-info',additionalMarginTop:80});
            {% endif %}
    
    // Reviews/Question scroll link
            $(".to_tabs").click(function() {
                $('html, body').animate({
                    scrollTop: ($(".main_tabs").offset().top - 100)
                }, 1000);
            });
    
    
        });
        //-->
</script>

{% if product_layout != "full-width" %}
<script>
    $(document).ready(function() {
            $('.image-additional a.link').click(function (e) {
                if ($(this).hasClass("locked")) {
                    e.stopImmediatePropagation();
                }
                $('.image-additional a.link.active').removeClass('active');
                $(this).addClass('active')
            });

            {% if images %}
            $('.cloud-zoom-wrap').click(function (e) {
                e.preventDefault();
                $('.image-additional a.link.active').removeClass('locked').trigger('click').addClass('locked');
            });
            {% else %}
            $('.cloud-zoom-wrap').click(function (e) {
                e.preventDefault();
                $('#main-image').trigger('click');
            });
            {% endif %}

            $('.image-additional').slick({
                prevArrow: "<a class=\"icon-arrow-left\"></a>",
                nextArrow: "<a class=\"icon-arrow-right\"></a>",
                appendArrows: '.image-additional .slick-list',
                arrows:true,
                {% if direction == 'rtl' %}
                rtl: true,
                {% endif %}
                infinite:false,
                {% if product_layout == "images-left" %}
                slidesToShow: {{ (img_h/img_a_h)|round(0, 'floor') }},
                vertical:true,
                verticalSwiping:true,
                {% else %}
                slidesToShow: {{ (img_w/img_a_w)|round }},
                {% endif %}
                responsive: [
                    {
                        breakpoint: 992,
                        settings: {
                            vertical:false,
                            verticalSwiping:false
                        }
                    }]
            });

        });
        //-->
</script>
{% endif %}
<script>
    $(document).ready(function() {
// Image Gallery
        $("#gallery").lightGallery({
            selector: '.link',
            download:false,
            hideBarsDelay:99999
        });
    });
    //-->
</script>


<div id="modal-size" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Vodič za veličine</h4>
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-responsive">
                        <tbody>
                            <tr>
                                <th>Veličina (EUR)</th>
                                <th>Veličina (EUR)</th>
                                <th>Prsa (cm)</th>
                                <th>Struk (cm)</th>
                                <th>Bokovi (cm)</th>
                            </tr>
                            <tr>
                                <td>XS</td>
                                <td>46</td>
                                <td>92-96</td>
                                <td>74-78</td>
                                <td>94-98</td>
                            </tr>
                            <tr>
                                <td>S</td>
                                <td>48</td>
                                <td>96-100</td>
                                <td>78-82</td>
                                <td>98-102</td>
                            </tr>
                            <tr>
                                <td>M</td>
                                <td>50</td>
                                <td>100-104</td>
                                <td>82-86</td>
                                <td>102-106</td>
                            </tr>
                            <tr>
                                <td>L</td>
                                <td>52</td>
                                <td>104-108</td>
                                <td>86-90</td>
                                <td>106-110</td>
                            </tr>
                            <tr>
                                <td>XL</td>
                                <td>54</td>
                                <td>108-114</td>
                                <td>90-94</td>
                                <td>110-114</td>
                            </tr>
                            <tr>
                                <td>XXL</td>
                                <td>56</td>
                                <td>114-120</td>
                                <td>94-96</td>
                                <td>114-118</td>
                            </tr>

                            <tr>
                                <td>XXXL</td>
                                <td>58</td>
                                <td>120-126</td>
                                <td>98-102</td>
                                <td>118-155</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>
{{ footer }}